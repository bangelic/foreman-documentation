[id="Upgrading_the_External_Database_{context}"]
= Upgrading the External Database

You can upgrade an external database from {EL} 7 to {EL} 8 while upgrading {Project} from {ProjectVersionPrevious} to {ProjectVersion}.

.Prerequisites
. On a virtual machine, take a snapshot.
. On a physical machine, create a backup.
. Create a new {EL} 8 based host for PostgreSQL server that follows the external database on {EL} 8 documentation.
For more information, see https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/using-databases#migrating-to-a-rhel-8-version-of-postgresql_using-postgresql[Migrating to a RHEL 8 version of PostgreSQL].

.Procedure
. Create a backup.
. If you keep the same hostname on the new PostgreSQL server, you need to update the DNS preventing the need to do updates on {Project} itself.
. If the new PostgreSQL server has a new host name or a different CNAME, update the reference to the external database on {Project}:
+
[options="nowrap", subs="+quotes,verbatim,attributes"]
----
# {foreman-installer} \
--foreman-db-host newpostgres.example.com \
--katello-candlepin-db-host newpostgres.example.com \
--foreman-proxy-content-pulpcore-postgresql-host newpostgres.example.com
----
. Copy the backup database to the new host.
. Restore the backup database on the new host.
